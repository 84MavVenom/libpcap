# The internal git client reads CIRRUS_CLONE_DEPTH.
env:
  CIRRUS_CLONE_DEPTH: 3
  MAKEFLAGS: '-j 2'
  IGNORE_OSVERSION: yes
  MATRIX_CC: 'clang gcc48 gcc10'

task:
  name: nested matrix
  freebsd_instance:
    image_family: freebsd-$OSREL
  env:
    matrix:
      - OSREL: 11-4
      - OSREL: 12-2
      - OSREL: 13-0-snap
  script:
    - freebsd-version
    - pkg install -qy autoconf gcc48 gcc10
    - pkg install -qy bash cmake git # for build_matrix.sh and build.sh
    - ./build_matrix.sh
